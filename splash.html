<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Oclin.bot</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            overflow: hidden;
            background: #0a0e17;
        }

        .app {
            width: 100%;
            height: 100vh;
            max-width: 500px;
            margin: auto;
            display: flex;
            flex-direction: column;
            background: linear-gradient(180deg, #12182b 0%, #1a2340 100%);
            position: relative;
            overflow: hidden;
        }

        /* -- Splash Screen Styles -- */
        .splash-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1f2f, #0b0e1a);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 0.5s ease-out;
            pointer-events: none;
        }
        .splash-screen.hidden {
            opacity: 0;
        }
        .splash-content {
            text-align: center;
            color: white;
        }
        .splash-content h1 {
            font-size: 42px;
            font-weight: 800;
            background: linear-gradient(135deg, #ffffff, #b886ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }
        .splash-content p {
            color: #a5b3d9;
            font-size: 18px;
        }
        /* ------------------------- */

        .header {
            padding: 15px;
            text-align: center;
            flex-shrink: 0;
        }

        .title {
            font-size: 26px;
            font-weight: 800;
            background: linear-gradient(135deg, #ffffff, #b886ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px 15px 90px 15px;
            scrollbar-width: none;
        }
        .main-content::-webkit-scrollbar {
            display: none;
        }

        .welcome-message {
            text-align: center;
            color: #a5b3d9;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .coins-title {
            color: #fff;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .coins-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ø§ÙˆÙŠØ© ÙƒÙ„ Ø¹Ù…Ù„Ø© Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø§ */
        .coin-vote-container {
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 25px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .coin-vote-container.selected {
            border-color: #ffd966;
            background: rgba(255, 215, 0, 0.1);
            transform: scale(1.02);
            margin: 5px 0;
        }

        .coin-card {
            background: transparent;
            border-radius: 20px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: .3s;
        }

        .coin-card.voted {
            opacity: .6;
            pointer-events: none;
        }

        .coin-card.disabled {
            opacity: .6;
            pointer-events: none;
        }

        .coin-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }

        .coin-icon img {
            width: 100%;
            height: 100%;
        }

        .coin-name {
            font-weight: 700;
            color: #fff;
        }

        .coin-symbol {
            font-size: 13px;
            color: #a5b3d9;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙˆÙŠØª - ØªØ¸Ù‡Ø± ØªØ­Øª ÙƒÙ„ Ø¹Ù…Ù„Ø© Ù…Ø­Ø¯Ø¯Ø© */
        .vote-options {
            display: none;
            justify-content: center;
            gap: 20px;
            padding: 0 15px 15px 15px;
            width: 100%;
        }

        .vote-options.show {
            display: flex;
        }

        .vote-btn {
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            border: 2px solid;
            background: rgba(10, 15, 30, 0.9);
            font-size: 14px;
        }

        .vote-up {
            border-color: #2ecc71;
            color: #2ecc71;
        }
        .vote-down {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .vote-btn.disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* ---- Profile Page Styles ---- */
        .profile-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
        }

        .profile-name {
            color: white;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .profile-username {
            color: #8B5CF6;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .profile-balance {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .balance-label {
            color: #a5b3d9;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .balance-amount {
            color: white;
            font-size: 32px;
            font-weight: 800;
        }

        .balance-amount span {
            font-size: 16px;
            color: #8B5CF6;
            margin-left: 5px;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
        }

        .profile-action-btn {
            flex: 1;
            padding: 15px;
            border-radius: 20px;
            border: none;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: 0.3s;
            background: rgba(255, 255, 255, 0.03);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-action-btn.primary {
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            border: none;
        }

        .profile-action-btn:hover {
            transform: translateY(-2px);
        }
        /* -------------------------------------------- */

        /* ---- Referral Page Styles ---- */
        .referral-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .referral-title {
            color: white;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
            text-align: center;
        }

        .referral-desc {
            color: #a5b3d9;
            font-size: 14px;
            text-align: center;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .referral-link-box {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .referral-link-box input {
            flex: 1;
            padding: 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.03);
            color: white;
            font-size: 14px;
            direction: ltr;
        }

        .referral-link-box button {
            padding: 15px 25px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
        }

        .referral-link-box button:hover {
            transform: scale(0.95);
        }

        .referral-stats-grid {
            display: flex;
            gap: 15px;
        }

        .referral-stat-item {
            flex: 1;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .referral-stat-number {
            color: white;
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .referral-stat-label {
            color: #a5b3d9;
            font-size: 14px;
        }
        /* -------------------------------------------- */

        /* ---- Tasks Page Styles with Real Icons ---- */
        .tasks-container {
            padding: 15px;
        }

        .tasks-section-title {
            color: white;
            font-size: 20px;
            font-weight: 700;
            margin: 20px 0 15px 0;
        }

        .social-links-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }

        .social-link-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: 0.3s;
        }

        .social-link-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.1);
        }

        .social-link-card.completed {
            opacity: 0.6;
            border-color: #2ecc71;
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª */
        .social-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .social-icon svg {
            width: 100%;
            height: 100%;
        }

        .social-name {
            color: white;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .social-username {
            color: #8B5CF6;
            font-size: 12px;
        }

        .social-reward {
            color: #2ecc71;
            font-size: 12px;
            margin-top: 8px;
            font-weight: 700;
        }

        .posts-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .post-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .post-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .post-info {
            flex: 1;
        }

        .post-platform {
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .post-time {
            color: #a5b3d9;
            font-size: 12px;
        }

        .post-content {
            color: white;
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
            padding-right: 52px;
        }

        .post-actions {
            display: flex;
            gap: 15px;
            padding-right: 52px;
        }

        .post-action-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: 0.3s;
        }

        .post-action-btn:hover {
            background: rgba(139, 92, 246, 0.3);
        }

        .post-action-btn.completed {
            background: #2ecc71;
            border-color: #2ecc71;
            pointer-events: none;
        }
        /* -------------------------------------------- */

        /* ---- Bottom Nav Glassmorphism ---- */
        .bottom-nav {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            display: flex;
            justify-content: space-around;
            background: rgba(20, 25, 40, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 12px;
            border-radius: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .nav-item {
            color: #a5b3d9;
            text-align: center;
            cursor: pointer;
            font-size: 20px;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .nav-item span {
            font-size: 12px;
            font-weight: 500;
        }

        .nav-item.active {
            color: #8B5CF6;
            transform: translateY(-2px);
        }

        .nav-item.active span {
            color: #8B5CF6;
        }
        /* --------------------------------- */

        .toast {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: #fff;
            padding: 10px 25px;
            border-radius: 50px;
            opacity: 0;
            transition: .3s;
            z-index: 200;
        }

        .toast.show {
            opacity: 1;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>

    <div class="app">

        <!-- splash screen -->
        <div id="splashScreen" class="splash-screen">
            <div class="splash-content">
                <h1>OCLIN BOT</h1>
                <p id="splashMessage">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
            </div>
        </div>

        <div class="header">
            <div class="title">OCLIN</div>
        </div>

        <div class="main-content">

            <!-- HOME -->
            <div id="homePage">
                <div class="welcome-message">ğŸ‘‹ Ø§Ø®ØªØ± Ø¹Ù…Ù„Ø© Ù„Ù„ØªØµÙˆÙŠØª <span id="votesCounter"
                        style="color: #ffd966; font-weight: bold;">(5/5)</span></div>

                <div class="coins-title">ğŸ“Š Ø¹Ù…Ù„Ø§Øª Solana Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
                <div class="coins-grid" id="coinsGrid"></div>
            </div>

            <!-- PROFILE -->
            <div id="profilePage" class="hidden">
                <div class="profile-card">
                    <div class="profile-avatar">ğŸ‘¤</div>
                    <div class="profile-name" id="profileDisplayName">Random User</div>
                    <div class="profile-username" id="profileUsername">@random_user</div>

                    <div class="profile-balance">
                        <div class="balance-label">Ø§Ù„Ø±ØµÙŠØ¯</div>
                        <div class="balance-amount">
                            <span id="profileBalance">0</span> <span>USD</span>
                        </div>
                    </div>

                    <div class="profile-actions">
                        <button class="profile-action-btn" onclick="showToast('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø©')">Ø±Ø¨Ø·
                            Ø§Ù„Ù…Ø­ÙØ¸Ø©</button>
                        <button class="profile-action-btn primary" onclick="showToast('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø§Ù„Ø³Ø­Ø¨')">Ø³Ø­Ø¨</button>
                    </div>
                </div>
            </div>

            <!-- REFERRAL -->
            <div id="referralPage" class="hidden">
                <div class="referral-container">
                    <h2 class="referral-title">ğŸ Ø¯Ø¹ÙˆØ© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</h2>
                    <p class="referral-desc">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ 15 Ù†Ù‚Ø·Ø© Ø¹Ù† ÙƒÙ„ ØµØ¯ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯ ÙŠÙ†Ø¶Ù… Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø·Ùƒ</p>

                    <div class="referral-link-box">
                        <input type="text" id="referralLink" readonly>
                        <button onclick="copyReferralLink()">Ù†Ø³Ø®</button>
                    </div>

                    <div class="referral-stats-grid">
                        <div class="referral-stat-item">
                            <div class="referral-stat-number" id="totalReferrals">0</div>
                            <div class="referral-stat-label">Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</div>
                        </div>
                        <div class="referral-stat-item">
                            <div class="referral-stat-number" id="referralBalance">0</div>
                            <div class="referral-stat-label">Ø§Ù„Ù†Ù‚Ø§Ø·</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TASKS -->
            <div id="tasksPage" class="hidden">
                <div class="tasks-container">

                    <div class="tasks-section-title">ğŸ“± ØªØ§Ø¨Ø¹Ù†Ø§ Ø¹Ù„Ù‰</div>
                    <div class="social-links-grid" id="socialLinksGrid"></div>

                    <div class="tasks-section-title">ğŸ“„ Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</div>
                    <div class="posts-grid" id="postsGrid"></div>

                </div>
            </div>

        </div>

        <!-- NAV -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showPage('home', event)">
                ğŸ 
                <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </div>
            <div class="nav-item" onclick="showPage('tasks', event)">
                ğŸ“‹
                <span>Ø§Ù„Ù…Ù‡Ø§Ù…</span>
            </div>
            <div class="nav-item" onclick="showPage('profile', event)">
                ğŸ‘¤
                <span>Ø§Ù„Ù…Ù„Ù</span>
            </div>
            <div class="nav-item" onclick="showPage('referral', event)">
                â†—ï¸
                <span>Ø§Ù„Ø¯Ø¹ÙˆØ©</span>
            </div>
        </div>

        <div class="toast" id="toast"></div>

    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        if (window.Telegram.WebApp) {
            Telegram.WebApp.expand();
            Telegram.WebApp.disableVerticalSwipes();
        }

        const DAILY_LIMIT = 5;
        const VOTE_REWARD = 10;
        const REFERRAL_REWARD = 15;
        const SOCIAL_TASK_REWARD = 5;

        // Ù…ØªØºÙŠØ±Ø§Øª ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù„Ù„Ø¹Ù…Ù„Ø§Øª
        let cachedCoins = [];
        let isFetchingCoins = false;
        let lastFetchTime = 0;
        const CACHE_DURATION = 60000;

        function playSound() {
            try {
                const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.2);
            } catch (e) {
                console.log("Audio not supported or blocked.");
            }
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù… Ø«Ø§Ø¨Øª
        function getOrCreateUserId() {
            let userId = localStorage.getItem("oclin_user_id");
            if (!userId) {
                userId = "user_" + Math.random().toString(36).substr(2, 9);
                localStorage.setItem("oclin_user_id", userId);
            }
            return userId;
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function loadUserData() {
            const userId = getOrCreateUserId();
            const savedData = localStorage.getItem("oclin_user_" + userId);

            if (savedData) {
                return JSON.parse(savedData);
            } else {
                // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯Ø©
                return {
                    id: userId,
                    balance: 0,
                    dailyVotes: 0,
                    votedCoins: {},
                    referralBalance: 0,
                    referralsCount: 0,
                    hasUsedReferral: false,
                    lastVoteDate: new Date().toDateString(),
                    completedTasks: {},
                    joinedAt: new Date().toISOString(),
                    referredBy: null
                };
            }
        }

        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function saveUserData() {
            localStorage.setItem("oclin_user_" + userData.id, JSON.stringify(userData));
        }

        let userData = loadUserData();

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØµÙˆÙŠØªØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
        function checkAndResetDailyVotes() {
            const today = new Date().toDateString();
            if (userData.lastVoteDate !== today) {
                userData.dailyVotes = 0;
                userData.votedCoins = {};
                userData.lastVoteDate = today;
                saveUserData();
            }
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        function checkForReferral() {
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ÙŠÙ„ Ù…Ù† Ø¹Ø¯Ø© Ù…ØµØ§Ø¯Ø±
            let referrerId = null;
            
            // 1. Ù…Ù† Telegram WebApp (Ø§Ù„Ø£Ù‡Ù…)
            if (window.Telegram?.WebApp?.initDataUnsafe?.start_param) {
                referrerId = window.Telegram.WebApp.initDataUnsafe.start_param;
                console.log('Referrer from Telegram WebApp:', referrerId);
            }
            
            // 2. Ù…Ù† URL parameters (ÙƒØ¨Ø¯ÙŠÙ„)
            if (!referrerId) {
                const urlParams = new URLSearchParams(window.location.search);
                referrerId = urlParams.get('startapp') || urlParams.get('start');
                console.log('Referrer from URL:', referrerId);
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ø§Ø¨Ø· Ø¥Ø­Ø§Ù„Ø©
            if (!referrerId) {
                document.getElementById('splashMessage').innerText = 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!';
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§ ÙŠØ¯Ø¹Ùˆ Ù†ÙØ³Ù‡
            if (referrerId === userData.id) {
                document.getElementById('splashMessage').innerText = 'Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø·Ùƒ Ø§Ù„Ø®Ø§Øµ!';
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ ØªÙ…Ø§Ù…Ø§Ù‹
            const isNewUser = !localStorage.getItem("oclin_user_" + userData.id);
            
            if (isNewUser) {
                console.log('Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø· Ø¥Ø­Ø§Ù„Ø© Ù…Ù†:', referrerId);
                
                // Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø­ÙŠÙ„
                const rewardGiven = giveReferralReward(referrerId);
                
                if (rewardGiven) {
                    // ØªØ³Ø¬ÙŠÙ„ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø§Ø¡ Ø¹Ø¨Ø± Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ÙŠÙ„
                    userData.referredBy = referrerId;
                    userData.hasUsedReferral = true;
                    saveUserData();
                    
                    document.getElementById('splashMessage').innerText = `ğŸ‰ Ù…Ø±Ø­Ø¨Ø§Ù‹! ØªÙ… ØªÙØ¹ÙŠÙ„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ÙˆØ¥Ø¶Ø§ÙØ© ${REFERRAL_REWARD} Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø­ÙŠÙ„`;
                    playSound();
                } else {
                    document.getElementById('splashMessage').innerText = 'Ø±Ø§Ø¨Ø· Ø¥Ø­Ø§Ù„Ø© ØºÙŠØ± ØµØ§Ù„Ø­';
                }
            } else {
                // Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹
                document.getElementById('splashMessage').innerText = 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø®ØµØµ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ ÙÙ‚Ø·';
                console.log('Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø­Ø§ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· Ø¥Ø­Ø§Ù„Ø©');
            }
        }

        // Ø¥Ø¹Ø·Ø§Ø¡ Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø­ÙŠÙ„
        function giveReferralReward(referrerId) {
            try {
                let referrerData = JSON.parse(localStorage.getItem("oclin_user_" + referrerId));
                
                if (referrerData) {
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø­ÙŠÙ„
                    referrerData.referralBalance = (referrerData.referralBalance || 0) + REFERRAL_REWARD;
                    referrerData.referralsCount = (referrerData.referralsCount || 0) + 1;
                    localStorage.setItem("oclin_user_" + referrerId, JSON.stringify(referrerData));
                    
                    console.log(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${REFERRAL_REWARD} Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø­ÙŠÙ„:`, referrerId);
                    return true;
                } else {
                    console.log('Ø§Ù„Ù…Ø­ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯:', referrerId);
                    return false;
                }
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„Ù†Ù‚Ø§Ø·:', e);
                return false;
            }
        }

        let selectedIndex = -1;
        const coinsGrid = document.getElementById("coinsGrid");
        let voteContainers = [];

        function updateVotesCounter() {
            const remainingVotes = DAILY_LIMIT - userData.dailyVotes;
            const counterElement = document.querySelector('#votesCounter');
            if (counterElement) {
                counterElement.textContent = `(${remainingVotes}/${DAILY_LIMIT})`;
            }
        }

        // Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø£Ø´Ù‡Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø¹Ù„Ù‰ Solana
        const POPULAR_SOLANA_TOKENS = [
            "So11111111111111111111111111111111111111112",
            "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
            "Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",
            "DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263",
            "7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU",
            "mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So",
            "J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",
            "bSo13r4TkiE4KumL71LsHTPpL2euBYLFx6h9HP3piy1",
            "9n4nbM75f5Ui33ZbPYXn59EwSgE8CGsHtAeTH5YFeJ9E",
            "2FPyTwcZLUg1MDrwsyoP4D6s1tM7hAkHYRjkNb5w6Pxk",
        ];

        async function fetchCoins(forceRefresh = false) {
            if (isFetchingCoins) return;

            if (!forceRefresh && cachedCoins.length > 0 && (Date.now() - lastFetchTime) < CACHE_DURATION) {
                displayCoins(cachedCoins);
                return;
            }

            try {
                isFetchingCoins = true;
                coinsGrid.innerHTML = '<p style="color:white;text-align:center;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¹Ù…Ù„Ø§Øª Solana...</p>';

                const uniqueCoins = new Map();

                for (const tokenAddress of POPULAR_SOLANA_TOKENS) {
                    try {
                        const res = await fetch(`https://api.dexscreener.com/latest/dex/tokens/${tokenAddress}`);
                        if (res.ok) {
                            const data = await res.json();
                            if (data.pairs && data.pairs.length > 0) {
                                const pair = data.pairs[0];
                                if (!uniqueCoins.has(pair.baseToken.address)) {
                                    uniqueCoins.set(pair.baseToken.address, {
                                        id: pair.baseToken.address,
                                        name: pair.baseToken.name,
                                        symbol: pair.baseToken.symbol,
                                        image: pair.info?.imageUrl || `https://via.placeholder.com/45?text=${pair.baseToken.symbol}`,
                                        current_price: pair.priceUsd || 0,
                                    });
                                }
                            }
                        }
                    } catch (e) {
                        console.log(`Error fetching token ${tokenAddress}:`, e);
                    }
                }

                if (uniqueCoins.size === 0) {
                    const mockCoins = [
                        { name: "Solana", symbol: "SOL", price: 98.5 },
                        { name: "Bonk", symbol: "BONK", price: 0.0000234 },
                        { name: "Jito", symbol: "JTO", price: 2.34 },
                        { name: "Raydium", symbol: "RAY", price: 1.23 },
                        { name: "Orca", symbol: "ORCA", price: 3.45 },
                        { name: "Samoyedcoin", symbol: "SAMO", price: 0.00567 },
                        { name: "Marinade", symbol: "mSOL", price: 112.3 },
                        { name: "Wrapped Bitcoin", symbol: "WBTC", price: 62345.67 },
                        { name: "Wrapped Ethereum", symbol: "WETH", price: 3456.78 },
                        { name: "USD Coin", symbol: "USDC", price: 1.00 }
                    ];

                    mockCoins.forEach((coin, index) => {
                        uniqueCoins.set('mock_' + index, {
                            id: 'mock_' + index,
                            name: coin.name,
                            symbol: coin.symbol,
                            image: `https://via.placeholder.com/45?text=${coin.symbol}`,
                            current_price: coin.price
                        });
                    });
                }

                const formattedCoins = Array.from(uniqueCoins.values()).slice(0, 15);
                cachedCoins = formattedCoins;
                lastFetchTime = Date.now();
                displayCoins(formattedCoins);

            } catch (error) {
                console.error("Error fetching coins:", error);

                if (cachedCoins.length > 0) {
                    displayCoins(cachedCoins);
                    showToast("Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©");
                } else {
                    coinsGrid.innerHTML = '<p style="color:white;text-align:center;">âš ï¸ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>';
                }
            } finally {
                isFetchingCoins = false;
            }
        }

        setInterval(() => {
            if (document.getElementById('homePage').classList.contains('hidden') === false) {
                fetchCoins(true);
            }
        }, 60000);

        function displayCoins(coins) {
            if (!coins || coins.length === 0) {
                coinsGrid.innerHTML = '<p style="color:white;text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Øª Ù…ØªØ§Ø­Ø©</p>';
                return;
            }

            coinsGrid.innerHTML = "";
            voteContainers = [];
            const hasVotesLeft = userData.dailyVotes < DAILY_LIMIT;

            coins.forEach((coin, i) => {
                const container = document.createElement("div");
                container.className = "coin-vote-container";
                container.dataset.index = i;

                const coinCard = document.createElement("div");
                coinCard.className = "coin-card";

                if (userData.votedCoins && userData.votedCoins[i]) {
                    coinCard.classList.add("voted");
                } else if (!hasVotesLeft) {
                    coinCard.classList.add("disabled");
                }

                coinCard.innerHTML = `
                    <div class="coin-icon"><img src="${coin.image}" alt="${coin.name}" onerror="this.src='https://via.placeholder.com/45?text=${coin.symbol}'"></div>
                    <div>
                        <div class="coin-name">${coin.name}</div>
                        <div class="coin-symbol">${coin.symbol.toUpperCase()}</div>
                        ${coin.current_price ? `<div class="coin-symbol" style="color:#2ecc71;">$${parseFloat(coin.current_price).toFixed(4)}</div>` : ''}
                    </div>`;

                const voteOptions = document.createElement("div");
                voteOptions.className = "vote-options";
                voteOptions.innerHTML = `
                    <div class="vote-btn vote-up ${!hasVotesLeft ? 'disabled' : ''}" onclick="castVote(${i}, 'up')">â¬†ï¸ Up</div>
                    <div class="vote-btn vote-down ${!hasVotesLeft ? 'disabled' : ''}" onclick="castVote(${i}, 'down')">â¬‡ï¸ Down</div>
                `;

                container.appendChild(coinCard);
                container.appendChild(voteOptions);

                if (hasVotesLeft && !userData.votedCoins?.[i]) {
                    coinCard.onclick = (e) => {
                        e.stopPropagation();
                        selectCoin(i, container);
                    };
                }

                coinsGrid.appendChild(container);
                voteContainers.push(container);
            });
        }

        function selectCoin(index, container) {
            if (userData.dailyVotes >= DAILY_LIMIT) {
                showToast("Ù„Ù‚Ø¯ Ø§Ø³ØªÙ†ÙØ°Øª Ø­Ø¯ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„ÙŠÙˆÙ…ÙŠ");
                return;
            }

            if (selectedIndex === index) {
                voteContainers.forEach(c => {
                    c.classList.remove("selected");
                    const voteOpts = c.querySelector('.vote-options');
                    if (voteOpts) voteOpts.classList.remove('show');
                });
                selectedIndex = -1;
                return;
            }

            if (userData.votedCoins && userData.votedCoins[index]) {
                showToast("Ù„Ù‚Ø¯ ØµÙˆØªØª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹");
                return;
            }

            voteContainers.forEach(c => {
                c.classList.remove("selected");
                const voteOpts = c.querySelector('.vote-options');
                if (voteOpts) voteOpts.classList.remove('show');
            });

            container.classList.add("selected");
            const voteOptions = container.querySelector('.vote-options');
            if (voteOptions) voteOptions.classList.add('show');

            selectedIndex = index;
        }

        function castVote(index, voteType) {
            if (selectedIndex !== index) {
                showToast("Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹");
                return;
            }

            if (userData.dailyVotes >= DAILY_LIMIT) {
                showToast("Ù„Ù‚Ø¯ Ø§Ø³ØªÙ†ÙØ°Øª Ø­Ø¯ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„ÙŠÙˆÙ…ÙŠ");
                return;
            }

            if (userData.votedCoins && userData.votedCoins[index]) {
                showToast("Ù„Ù‚Ø¯ ØµÙˆØªØª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹");
                return;
            }

            userData.balance += VOTE_REWARD;
            userData.dailyVotes++;

            if (!userData.votedCoins) {
                userData.votedCoins = {};
            }
            userData.votedCoins[index] = true;

            saveUserData();

            document.getElementById("profileBalance").innerText = userData.balance;
            updateVotesCounter();
            showToast(`âœ… ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª Ø¨Ù†Ø¬Ø§Ø­! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${VOTE_REWARD} Ù†Ù‚Ø§Ø·`);

            if (voteContainers[index]) {
                voteContainers[index].classList.remove("selected");
                const voteOpts = voteContainers[index].querySelector('.vote-options');
                if (voteOpts) voteOpts.classList.remove('show');
            }

            const coinCard = voteContainers[index]?.querySelector('.coin-card');
            if (coinCard) coinCard.classList.add('voted');

            selectedIndex = -1;

            if (userData.dailyVotes >= DAILY_LIMIT) {
                setTimeout(() => {
                    displayCoins(cachedCoins);
                }, 500);
            }
        }

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù…
        const socialLinks = [
            {
                platform: 'youtube',
                name: 'ÙŠÙˆØªÙŠÙˆØ¨',
                username: '@oclin_official',
                url: 'https://youtube.com/@oclin',
                reward: 5,
                icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#FF0000"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>`
            },
            {
                platform: 'telegram',
                name: 'ØªÙ„ÙŠÙƒØ±Ø§Ù…',
                username: '@oclin_channel',
                url: 'https://t.me/oclin_channel',
                reward: 5,
                icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#26A5E4"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.201-.82 1.23-.697.064-1.226-.46-1.901-.902-1.056-.69-1.653-1.12-2.68-1.794-1.185-.777-.417-1.203.258-1.9.177-.183 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.79 1.138-5.055 3.345-.479.33-.913.49-1.302.481-.428-.01-1.252-.242-1.865-.442-.751-.245-1.349-.374-1.297-.789.028-.216.324-.437.893-.663 3.499-1.524 5.832-2.529 7-3.014 3.332-1.386 4.025-1.627 4.476-1.635.099-.002.322.023.466.14.121.099.154.232.17.33.016.099.036.324.02.5z"/></svg>`
            },
            {
                platform: 'x',
                name: 'X (Twitter)',
                username: '@oclin',
                url: 'https://x.com/oclin',
                reward: 5,
                icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#1DA1F2"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>`
            },
            {
                platform: 'instagram',
                name: 'Ø§Ù†Ø³ØªØºØ±Ø§Ù…',
                username: '@oclin',
                url: 'https://instagram.com/oclin',
                reward: 5,
                icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#E4405F"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm4.965-10.405a1.44 1.44 0 1 1 2.881.001 1.44 1.44 0 0 1-2.881-.001z"/></svg>`
            },
            {
                platform: 'tiktok',
                name: 'ØªÙŠÙƒ ØªÙˆÙƒ',
                username: '@oclin',
                url: 'https://tiktok.com/@oclin',
                reward: 5,
                icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#000000"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>`
            }
        ];

        const samplePosts = [
            { platform: 'ÙŠÙˆØªÙŠÙˆØ¨', username: '@oclin', content: 'ğŸš€ Ø´Ø±Ø­ Ø¬Ø¯ÙŠØ¯: ÙƒÙŠÙ ØªØ±Ø¨Ø­ Ù…Ù† Ø§Ù„ØªØµÙˆÙŠØª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø§Øª! Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø¢Ù†', time: 'Ù…Ù†Ø° Ø³Ø§Ø¹Ø©', avatar: 'ğŸ“º' },
            { platform: 'ØªÙ„ÙŠÙƒØ±Ø§Ù…', username: '@oclin', content: 'ğŸª™ ØªÙ… Ø¥Ø¶Ø§ÙØ© 5 Ø¹Ù…Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªØµÙˆÙŠØª! Ø§Ø¯Ø®Ù„ ÙˆØµÙˆØª Ø§Ù„Ø¢Ù†', time: 'Ù…Ù†Ø° 3 Ø³Ø§Ø¹Ø§Øª', avatar: 'ğŸ“±' },
            { platform: 'X', username: '@oclin', content: 'ğŸ”¥ Ù…Ø³Ø§Ø¨Ù‚Ø© ÙƒØ¨Ø±Ù‰! 1000 Ù†Ù‚Ø·Ø© Ù„Ù„ÙØ§Ø¦Ø²ÙŠÙ† Ø§Ù„Ø®Ù…Ø³Ø© Ø§Ù„Ø£ÙˆØ§Ø¦Ù„', time: 'Ù…Ù†Ø° 5 Ø³Ø§Ø¹Ø§Øª', avatar: 'ğŸ¦' },
            { platform: 'Ø§Ù†Ø³ØªØºØ±Ø§Ù…', username: '@oclin', content: 'ğŸ“¸ ØµÙˆØ± Ø­ØµØ±ÙŠØ© Ù…Ù† Ù„Ù‚Ø§Ø¡ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ù…Ø¹ ÙØ±ÙŠÙ‚ OCLIN', time: 'Ù…Ù†Ø° ÙŠÙˆÙ…', avatar: 'ğŸ“·' },
            { platform: 'ØªÙŠÙƒ ØªÙˆÙƒ', username: '@oclin', content: 'ğŸ¬ ÙƒÙŠÙ ØªØµØ¨Ø­ Ù…Ù„ÙŠÙˆÙ†ÙŠØ± Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©ØŸ #crypto #solana', time: 'Ù…Ù†Ø° ÙŠÙˆÙ…ÙŠÙ†', avatar: 'ğŸµ' }
        ];

        function initTasksPage() {
            const socialGrid = document.getElementById('socialLinksGrid');
            socialGrid.innerHTML = '';

            socialLinks.forEach(link => {
                const card = document.createElement('div');
                card.className = `social-link-card ${userData.completedTasks?.[link.platform] ? 'completed' : ''}`;
                card.innerHTML = `
                    <div class="social-icon">${link.icon}</div>
                    <div class="social-name">${link.name}</div>
                    <div class="social-username">${link.username}</div>
                    <div class="social-reward">+${link.reward} Ù†Ù‚Ø§Ø·</div>
                `;
                card.onclick = () => completeSocialTask(link);
                socialGrid.appendChild(card);
            });

            const postsGrid = document.getElementById('postsGrid');
            postsGrid.innerHTML = '';

            samplePosts.forEach((post, index) => {
                const postDiv = document.createElement('div');
                postDiv.className = 'post-card';
                postDiv.innerHTML = `
                    <div class="post-header">
                        <div class="post-avatar">${post.avatar}</div>
                        <div class="post-info">
                            <div class="post-platform">${post.platform}</div>
                            <div class="post-time">${post.time}</div>
                        </div>
                    </div>
                    <div class="post-content">${post.content}</div>
                    <div class="post-actions">
                        <button class="post-action-btn ${userData.completedTasks?.['post_' + index] ? 'completed' : ''}" onclick="likePost(${index})">
                            ${userData.completedTasks?.['post_' + index] ? 'âœ… ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨' : 'ğŸ‘ Ø¥Ø¹Ø¬Ø§Ø¨ +5'}
                        </button>
                    </div>
                `;
                postsGrid.appendChild(postDiv);
            });
        }

        function completeSocialTask(link) {
            if (!userData.completedTasks) userData.completedTasks = {};

            if (userData.completedTasks[link.platform]) {
                showToast('Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                return;
            }

            window.open(link.url, '_blank');

            userData.balance += link.reward;
            userData.completedTasks[link.platform] = true;
            saveUserData();

            document.getElementById("profileBalance").innerText = userData.balance;
            showToast(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${link.reward} Ù†Ù‚Ø§Ø· Ù„Ù…ØªØ§Ø¨Ø¹Ø© ${link.name}`);

            initTasksPage();
        }

        function likePost(index) {
            if (!userData.completedTasks) userData.completedTasks = {};

            if (userData.completedTasks['post_' + index]) {
                showToast('Ù„Ù‚Ø¯ Ø£Ø¹Ø¬Ø¨Øª Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                return;
            }

            userData.balance += 5;
            userData.completedTasks['post_' + index] = true;
            saveUserData();

            document.getElementById("profileBalance").innerText = userData.balance;
            showToast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© 5 Ù†Ù‚Ø§Ø·! Ø´ÙƒØ±Ø§Ù‹ Ù„Ù„Ø¥Ø¹Ø¬Ø§Ø¨');

            initTasksPage();
        }

        function showPage(page, event) {
            if (event) {
                document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
                event.currentTarget.classList.add("active");
            }

            document.getElementById("homePage").classList.add("hidden");
            document.getElementById("profilePage").classList.add("hidden");
            document.getElementById("referralPage").classList.add("hidden");
            document.getElementById("tasksPage").classList.add("hidden");

            document.getElementById(page + "Page").classList.remove("hidden");

            if (page === 'referral') {
                updateReferralDisplay();
            } else if (page === 'home') {
                checkAndResetDailyVotes();
                updateVotesCounter();
                selectedIndex = -1;
                if (cachedCoins.length > 0) {
                    displayCoins(cachedCoins);
                } else {
                    fetchCoins();
                }
            } else if (page === 'tasks') {
                initTasksPage();
            } else if (page === 'profile') {
                document.getElementById("profileBalance").innerText = userData.balance;
                document.getElementById("profileDisplayName").innerText = "OCLIN User";
                document.getElementById("profileUsername").innerText = "@user_" + userData.id.substr(0, 8);
            }
        }

        function showToast(msg) {
            const t = document.getElementById("toast");
            t.innerText = msg;
            t.classList.add("show");
            setTimeout(() => t.classList.remove("show"), 2000);
        }

        function copyReferralLink() {
            const linkInput = document.getElementById("referralLink");
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(linkInput.value).then(() => {
                showToast("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!");
            }).catch(err => {
                showToast("ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®");
            });
        }

        function updateReferralDisplay() {
            // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­ Ù„ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØºØ± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨ÙˆØª
            const botUsername = "oclin_vote_bot";
            
            // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ù„Ø¯Ø§Ø¹ÙŠ)
            const referrerId = userData.id;
            
            // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø³Ø­Ø±ÙŠ - ÙŠÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨ÙˆØª
            const miniAppLink = `https://t.me/${botUsername}/start?startapp=${referrerId}`;
            
            document.getElementById("referralLink").value = miniAppLink;
            document.getElementById("referralBalance").innerText = userData.referralBalance || 0;
            document.getElementById("totalReferrals").innerText = userData.referralsCount || 0;
            
            console.log('Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©:', miniAppLink);
        }

        function init() {
            checkAndResetDailyVotes();
            checkForReferral();

            document.getElementById("profileBalance").innerText = userData.balance;
            updateVotesCounter();
            updateReferralDisplay();

            fetchCoins();

            setTimeout(() => {
                document.getElementById('splashScreen').classList.add('hidden');
            }, 2000);
        }

        document.addEventListener("DOMContentLoaded", init);

    </script>

</body>

</html>
